import test from '@interactjs/_dev/test/test';
import * as utils from '@interactjs/utils';
import DropEvent from '../../drop/DropEvent';
const dz1 = { target: 'dz1', fire(event) { this.fired = event; } };
const dz2 = { target: 'dz2', fire(event) { this.fired = event; } };
const el1 = Symbol('el1');
const el2 = Symbol('el2');
const interactable = Symbol('interactable');
const dragElement = Symbol('drag-el');
test('DropEvent constructor', (t) => {
    const interaction = { dropStatus: {} };
    const dragEvent = Object.freeze({ interaction, interactable, target: dragElement, timeStamp: 10 });
    utils.extend(interaction.dropStatus, {
        activeDrops: [
            { dropzone: dz1, element: el1 },
            { dropzone: dz2, element: el2 },
        ],
        cur: { dropzone: dz1, element: el1 },
        prev: { dropzone: dz2, element: el2 },
        events: {},
    });
    const dropmove = new DropEvent(interaction.dropStatus, dragEvent, 'dropmove');
    t.equal(dropmove.target, el1, 'dropmove uses dropStatus.cur.element');
    t.equal(dropmove.dropzone, dz1, 'dropmove uses dropStatus.cur.dropzone');
    t.equal(dropmove.relatedTarget, dragElement);
    const dragleave = new DropEvent(interaction.dropStatus, dragEvent, 'dragleave');
    t.equal(dragleave.target, el2, 'dropmove uses dropStatus.prev.element');
    t.equal(dragleave.dropzone, dz2, 'dropmove uses dropStatus.prev.dropzone');
    t.equal(dragleave.relatedTarget, dragElement);
    t.end();
});
test('DropEvent.reject()', (t) => {
    const interaction = { dropStatus: {} };
    const dragEvent = Object.freeze({ interaction, interactable, target: dragElement, timeStamp: 10 });
    utils.extend(interaction.dropStatus, {
        activeDrops: [
            { dropzone: dz1, element: el1 },
            { dropzone: dz2, element: el2 },
        ],
        cur: { dropzone: null, element: null },
        prev: { dropzone: null, element: null },
        events: {},
    });
    const dropactivate = new DropEvent(interaction.dropStatus, dragEvent, 'dropactivate');
    dropactivate.dropzone = dz1;
    dropactivate.target = el1;
    dropactivate.reject();
    t.ok(dropactivate.propagationStopped && dropactivate.immediatePropagationStopped, 'rejected event propagation is stopped');
    t.equal(dz1.fired.type, 'dropdeactivate', 'dropdeactivate is fired on rejected dropzone');
    t.deepEqual(interaction.dropStatus.activeDrops, [{ dropzone: dz2, element: el2 }], 'activeDrop of rejected dropactivate event is removed');
    t.deepEqual(interaction.dropStatus.cur, { dropzone: null, element: null }, 'dropStatus.cur dropzone and element are set to null after rejecting dropactivate');
    utils.extend(interaction.dropStatus, {
        cur: { dropzone: dz1, element: el1 },
        prev: { dropzone: null, element: null },
        events: {},
    });
    const dropmove = new DropEvent(interaction.dropStatus, dragEvent, 'dropmove');
    dropmove.reject();
    t.deepEqual(interaction.dropStatus.cur, { dropzone: dz1, element: el1 }, 'dropStatus.cur remains the same after rejecting non activate event');
    t.ok(interaction.dropStatus.rejected, 'dropStatus.rejected === true');
    t.equal(dz1.fired.type, 'dragleave', 'dragleave is fired on rejected dropzone');
    t.end();
});
test('DropEvent.stop[Immediate]Propagation()', (t) => {
    const dropEvent = new DropEvent({ cur: {} }, {}, 'dragmove');
    t.notOk(dropEvent.propagationStopped || dropEvent.immediatePropagationStopped);
    dropEvent.stopPropagation();
    t.ok(dropEvent.propagationStopped);
    t.notOk(dropEvent.immediatePropagationStopped);
    dropEvent.propagationStopped = false;
    dropEvent.stopImmediatePropagation();
    t.ok(dropEvent.propagationStopped && dropEvent.immediatePropagationStopped);
    t.end();
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRHJvcEV2ZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiRHJvcEV2ZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sSUFBSSxNQUFNLDRCQUE0QixDQUFBO0FBQzdDLE9BQU8sS0FBSyxLQUFLLE1BQU0sbUJBQW1CLENBQUE7QUFDMUMsT0FBTyxTQUFTLE1BQU0sc0JBQXNCLENBQUE7QUFFNUMsTUFBTSxHQUFHLEdBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBRSxLQUFLLElBQUksSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUEsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtBQUN2RSxNQUFNLEdBQUcsR0FBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFFLEtBQUssSUFBSSxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQSxDQUFDLENBQUMsRUFBRSxDQUFBO0FBQ3ZFLE1BQU0sR0FBRyxHQUFRLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUM5QixNQUFNLEdBQUcsR0FBUSxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDOUIsTUFBTSxZQUFZLEdBQVEsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFBO0FBQ2hELE1BQU0sV0FBVyxHQUFRLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQTtBQUUxQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTtJQUNsQyxNQUFNLFdBQVcsR0FBRyxFQUFFLFVBQVUsRUFBRSxFQUFFLEVBQUUsQ0FBQTtJQUN0QyxNQUFNLFNBQVMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFBO0lBRWxHLEtBQUssQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRTtRQUNuQyxXQUFXLEVBQUU7WUFD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Q0FBQyx3Q0FBd0MsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFO0lBQ25ELE1BQU0sU0FBUyxHQUFHLElBQUksU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxVQUFVLENBQUMsQ0FBQTtJQUU1RCxDQUFDLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsSUFBSSxTQUFTLENBQUMsMkJBQTJCLENBQUMsQ0FBQTtJQUU5RSxTQUFTLENBQUMsZUFBZSxFQUFFLENBQUE7SUFDM0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsQ0FBQTtJQUNsQyxDQUFDLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQywyQkFBMkIsQ0FBQyxDQUFBO0lBRTlDLFNBQVMsQ0FBQyxrQkFBa0IsR0FBRyxLQUFLLENBQUE7SUFFcEMsU0FBUyxDQUFDLHdCQUF3QixFQUFFLENBQUE7SUFDcEMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsa0JBQWtCLElBQUksU0FBUyxDQUFDLDJCQUEyQixDQUFDLENBQUE7SUFFM0UsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFBO0FBQ1QsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdGVzdCBmcm9tICdAaW50ZXJhY3Rqcy9fZGV2L3Rlc3QvdGVzdCdcbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gJ0BpbnRlcmFjdGpzL3V0aWxzJ1xuaW1wb3J0IERyb3BFdmVudCBmcm9tICcuLi8uLi9kcm9wL0Ryb3BFdmVudCdcblxuY29uc3QgZHoxOiBhbnkgPSB7IHRhcmdldDogJ2R6MScsIGZpcmUgKGV2ZW50KSB7IHRoaXMuZmlyZWQgPSBldmVudCB9IH1cbmNvbnN0IGR6MjogYW55ID0geyB0YXJnZXQ6ICdkejInLCBmaXJlIChldmVudCkgeyB0aGlzLmZpcmVkID0gZXZlbnQgfSB9XG5jb25zdCBlbDE6IGFueSA9IFN5bWJvbCgnZWwxJylcbmNvbnN0IGVsMjogYW55ID0gU3ltYm9sKCdlbDInKVxuY29uc3QgaW50ZXJhY3RhYmxlOiBhbnkgPSBTeW1ib2woJ2ludGVyYWN0YWJsZScpXG5jb25zdCBkcmFnRWxlbWVudDogYW55ID0gU3ltYm9sKCdkcmFnLWVsJylcblxudGVzdCgnRHJvcEV2ZW50IGNvbnN0cnVjdG9yJywgKHQpID0+IHtcbiAgY29uc3QgaW50ZXJhY3Rpb24gPSB7IGRyb3BTdGF0dXM6IHt9IH1cbiAgY29uc3QgZHJhZ0V2ZW50ID0gT2JqZWN0LmZyZWV6ZSh7IGludGVyYWN0aW9uLCBpbnRlcmFjdGFibGUsIHRhcmdldDogZHJhZ0VsZW1lbnQsIHRpbWVTdGFtcDogMTAgfSlcblxuICB1dGlscy5leHRlbmQoaW50ZXJhY3Rpb24uZHJvcFN0YXR1cywge1xuICAgIGFjdGl2ZURyb3BzOiBbXG4gICAgICB7IGRyb3B6b25lOiBkejEsIGVsZW1lbnQ6IGVsMSB9LFxuICAgICAgeyBkcm9wem9uZTogZHoyLCBlbGVtZW50OiBlbDIgfSxcbiAgICBdLFxuICAgIGN1ciA6IHsgZHJvcHpvbmU6IGR6MSwgZWxlbWVudDogZWwxIH0sXG4gICAgcHJldjogeyBkcm9wem9uZTogZHoyLCBlbGVtZW50OiBlbDIgfSxcbiAgICBldmVudHM6IHt9LFxuICB9KVxuXG4gIGNvbnN0IGRyb3Btb3ZlID0gbmV3IERyb3BFdmVudChpbnRlcmFjdGlvbi5kcm9wU3RhdHVzLCBkcmFnRXZlbnQsICdkcm9wbW92ZScpXG5cbiAgdC5lcXVhbChkcm9wbW92ZS50YXJnZXQsIGVsMSwgJ2Ryb3Btb3ZlIHVzZXMgZHJvcFN0YXR1cy5jdXIuZWxlbWVudCcpXG4gIHQuZXF1YWwoZHJvcG1vdmUuZHJvcHpvbmUsIGR6MSwgJ2Ryb3Btb3ZlIHVzZXMgZHJvcFN0YXR1cy5jdXIuZHJvcHpvbmUnKVxuICB0LmVxdWFsKGRyb3Btb3ZlLnJlbGF0ZWRUYXJnZXQsIGRyYWdFbGVtZW50KVxuXG4gIGNvbnN0IGRyYWdsZWF2ZSA9IG5ldyBEcm9wRXZlbnQoaW50ZXJhY3Rpb24uZHJvcFN0YXR1cywgZHJhZ0V2ZW50LCAnZHJhZ2xlYXZlJylcblxuICB0LmVxdWFsKGRyYWdsZWF2ZS50YXJnZXQsIGVsMiwgJ2Ryb3Btb3ZlIHVzZXMgZHJvcFN0YXR1cy5wcmV2LmVsZW1lbnQnKVxuICB0LmVxdWFsKGRyYWdsZWF2ZS5kcm9wem9uZSwgZHoyLCAnZHJvcG1vdmUgdXNlcyBkcm9wU3RhdHVzLnByZXYuZHJvcHpvbmUnKVxuICB0LmVxdWFsKGRyYWdsZWF2ZS5yZWxhdGVkVGFyZ2V0LCBkcmFnRWxlbWVudClcblxuICB0LmVuZCgpXG59KVxuXG50ZXN0KCdEcm9wRXZlbnQucmVqZWN0KCknLCAodCkgPT4ge1xuICBjb25zdCBpbnRlcmFjdGlvbjogYW55ID0geyBkcm9wU3RhdHVzOiB7fSB9XG4gIGNvbnN0IGRyYWdFdmVudCA9IE9iamVjdC5mcmVlemUoeyBpbnRlcmFjdGlvbiwgaW50ZXJhY3RhYmxlLCB0YXJnZXQ6IGRyYWdFbGVtZW50LCB0aW1lU3RhbXA6IDEwIH0pXG5cbiAgdXRpbHMuZXh0ZW5kKGludGVyYWN0aW9uLmRyb3BTdGF0dXMsIHtcbiAgICBhY3RpdmVEcm9wczogW1xuICAgICAgeyBkcm9wem9uZTogZHoxLCBlbGVtZW50OiBlbDEgfSxcbiAgICAgIHsgZHJvcHpvbmU6IGR6MiwgZWxlbWVudDogZWwyIH0sXG4gICAgXSxcbiAgICBjdXIgOiB7IGRyb3B6b25lOiBudWxsLCBlbGVtZW50OiBudWxsIH0sXG4gICAgcHJldjogeyBkcm9wem9uZTogbnVsbCwgZWxlbWVudDogbnVsbCB9LFxuICAgIGV2ZW50czoge30sXG4gIH0pXG5cbiAgY29uc3QgZHJvcGFjdGl2YXRlID0gbmV3IERyb3BFdmVudChpbnRlcmFjdGlvbi5kcm9wU3RhdHVzLCBkcmFnRXZlbnQsICdkcm9wYWN0aXZhdGUnKVxuXG4gIGRyb3BhY3RpdmF0ZS5kcm9wem9uZSA9IGR6MVxuICBkcm9wYWN0aXZhdGUudGFyZ2V0ID0gZWwxXG4gIGRyb3BhY3RpdmF0ZS5yZWplY3QoKVxuXG4gIHQub2soZHJvcGFjdGl2YXRlLnByb3BhZ2F0aW9uU3RvcHBlZCAmJiBkcm9wYWN0aXZhdGUuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkLFxuICAgICdyZWplY3RlZCBldmVudCBwcm9wYWdhdGlvbiBpcyBzdG9wcGVkJylcblxuICB0LmVxdWFsKGR6MS5maXJlZC50eXBlLCAnZHJvcGRlYWN0aXZhdGUnLCAnZHJvcGRlYWN0aXZhdGUgaXMgZmlyZWQgb24gcmVqZWN0ZWQgZHJvcHpvbmUnKVxuXG4gIHQuZGVlcEVxdWFsKFxuICAgIGludGVyYWN0aW9uLmRyb3BTdGF0dXMuYWN0aXZlRHJvcHMsXG4gICAgW3sgZHJvcHpvbmU6IGR6MiwgZWxlbWVudDogZWwyIH1dLFxuICAgICdhY3RpdmVEcm9wIG9mIHJlamVjdGVkIGRyb3BhY3RpdmF0ZSBldmVudCBpcyByZW1vdmVkJylcblxuICB0LmRlZXBFcXVhbChcbiAgICBpbnRlcmFjdGlvbi5kcm9wU3RhdHVzLmN1cixcbiAgICB7IGRyb3B6b25lOiBudWxsLCBlbGVtZW50OiBudWxsIH0sXG4gICAgJ2Ryb3BTdGF0dXMuY3VyIGRyb3B6b25lIGFuZCBlbGVtZW50IGFyZSBzZXQgdG8gbnVsbCBhZnRlciByZWplY3RpbmcgZHJvcGFjdGl2YXRlJylcblxuICB1dGlscy5leHRlbmQoaW50ZXJhY3Rpb24uZHJvcFN0YXR1cywge1xuICAgIGN1ciA6IHsgZHJvcHpvbmU6IGR6MSwgZWxlbWVudDogZWwxIH0sXG4gICAgcHJldjogeyBkcm9wem9uZTogbnVsbCwgZWxlbWVudDogbnVsbCB9LFxuICAgIGV2ZW50czoge30sXG4gIH0pXG5cbiAgY29uc3QgZHJvcG1vdmUgPSBuZXcgRHJvcEV2ZW50KGludGVyYWN0aW9uLmRyb3BTdGF0dXMsIGRyYWdFdmVudCwgJ2Ryb3Btb3ZlJylcblxuICBkcm9wbW92ZS5yZWplY3QoKVxuXG4gIHQuZGVlcEVxdWFsKFxuICAgIGludGVyYWN0aW9uLmRyb3BTdGF0dXMuY3VyLFxuICAgIHsgZHJvcHpvbmU6IGR6MSwgZWxlbWVudDogZWwxIH0sXG4gICAgJ2Ryb3BTdGF0dXMuY3VyIHJlbWFpbnMgdGhlIHNhbWUgYWZ0ZXIgcmVqZWN0aW5nIG5vbiBhY3RpdmF0ZSBldmVudCcpXG5cbiAgdC5vayhpbnRlcmFjdGlvbi5kcm9wU3RhdHVzLnJlamVjdGVkLCAnZHJvcFN0YXR1cy5yZWplY3RlZCA9PT0gdHJ1ZScpXG5cbiAgdC5lcXVhbChkejEuZmlyZWQudHlwZSwgJ2RyYWdsZWF2ZScsICdkcmFnbGVhdmUgaXMgZmlyZWQgb24gcmVqZWN0ZWQgZHJvcHpvbmUnKVxuXG4gIHQuZW5kKClcbn0pXG5cbnRlc3QoJ0Ryb3BFdmVudC5zdG9wW0ltbWVkaWF0ZV1Qcm9wYWdhdGlvbigpJywgKHQpID0+IHtcbiAgY29uc3QgZHJvcEV2ZW50ID0gbmV3IERyb3BFdmVudCh7IGN1cjoge30gfSwge30sICdkcmFnbW92ZScpXG5cbiAgdC5ub3RPayhkcm9wRXZlbnQucHJvcGFnYXRpb25TdG9wcGVkIHx8IGRyb3BFdmVudC5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQpXG5cbiAgZHJvcEV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG4gIHQub2soZHJvcEV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZClcbiAgdC5ub3RPayhkcm9wRXZlbnQuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKVxuXG4gIGRyb3BFdmVudC5wcm9wYWdhdGlvblN0b3BwZWQgPSBmYWxzZVxuXG4gIGRyb3BFdmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKVxuICB0Lm9rKGRyb3BFdmVudC5wcm9wYWdhdGlvblN0b3BwZWQgJiYgZHJvcEV2ZW50LmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZClcblxuICB0LmVuZCgpXG59KVxuIl19