import test from '@interactjs/_dev/test/test';
import drag from '@interactjs/actions/drag';
import * as helpers from '@interactjs/core/tests/_helpers';
import inertia from './';
test('inertia', (t) => {
    const { scope, interaction, target, interactable, coords, event, } = helpers.testEnv({ plugins: [inertia, drag] });
    const element = target;
    const modifierChange = 5;
    const testModifier = {
        options: { endOnly: true },
        methods: { set({ coords: modifierCoords }) {
                modifierCoords.x += modifierChange;
                modifierCoords.y += modifierChange;
                modifierCallCount++;
            } },
    };
    let modifierCallCount = 0;
    coords.client = coords.page;
    scope.now = () => coords.timeStamp;
    interactable.draggable({ inertia: true });
    // test inertia without modifiers or throw
    downStartMoveUp({ x: 100, y: 0, dt: 1000 });
    t.notOk(interaction.inertia.active, '{ modifiers: [] } && !thrown: inertia is not activated');
    // test inertia without modifiers and with throw
    downStartMoveUp({ x: 100, y: 0, dt: 10 });
    t.ok(interaction.inertia.active, 'thrown: inertia is activated');
    interactable.draggable({ modifiers: [testModifier] });
    // test inertia with { endOnly: true } modifier and with throw
    downStartMoveUp({ x: 100, y: 0, dt: 10 });
    t.equal(modifierCallCount, 1, '{ endOnly: true } && thrown: modifier is not called from pointerUp');
    t.deepEqual(helpers.getProps(interaction.inertia, ['modifiedXe', 'modifiedYe']), {
        modifiedXe: interaction.inertia.xe + modifierChange,
        modifiedYe: interaction.inertia.ye + modifierChange,
    }, '{ endOnly: true } && thrown: inertia target coords are correct');
    // test smoothEnd with { endOnly: false } modifier
    testModifier.options.endOnly = false;
    downStartMoveUp({ x: 1, y: 0, dt: 1000 });
    t.notOk(interaction.inertia.active, '{ endOnly: false } && !thrown: inertia smoothEnd is not activated');
    t.equal(modifierCallCount, 2, '{ endOnly: false } && !thrown: modifier is called from pointerUp');
    // test smoothEnd with { endOnly: true } modifier
    testModifier.options.endOnly = true;
    downStartMoveUp({ x: 1, y: 0, dt: 1000 });
    t.ok(interaction.inertia.active, '{ endOnly: true } && !thrown: inertia smoothEnd is activated');
    t.equal(modifierCallCount, 1, '{ endOnly: true } && !thrown: modifier is not called from pointerUp');
    interaction.stop();
    t.end();
    function downStartMoveUp({ x, y, dt }) {
        modifierCallCount = 0;
        coords.timeStamp = 0;
        interaction.stop();
        Object.assign(coords.page, { x: 0, y: 0 });
        interaction.pointerDown(event, event, element);
        interaction.start({ name: 'drag' }, interactable, element);
        Object.assign(coords.page, { x, y });
        coords.timeStamp = dt;
        interaction.pointerMove(event, event, element);
        interaction.pointerUp(event, event, element, element);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5lcnRpYS5zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaW5lcnRpYS5zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sSUFBSSxNQUFNLDRCQUE0QixDQUFBO0FBQzdDLE9BQU8sSUFBSSxNQUFNLDBCQUEwQixDQUFBO0FBQzNDLE9BQU8sS0FBSyxPQUFPLE1BQU0saUNBQWlDLENBQUE7QUFDMUQsT0FBTyxPQUFPLE1BQU0sSUFBSSxDQUFBO0FBRXhCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTtJQUNwQixNQUFNLEVBQ0osS0FBSyxFQUNMLFdBQVcsRUFDWCxNQUFNLEVBQ04sWUFBWSxFQUNaLE1BQU0sRUFDTixLQUFLLEdBQ04sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQTtJQUNqRCxNQUFNLE9BQU8sR0FBRyxNQUFxQixDQUFBO0lBQ3JDLE1BQU0sY0FBYyxHQUFHLENBQUMsQ0FBQTtJQUN4QixNQUFNLFlBQVksR0FBRztRQUNuQixPQUFPLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO1FBQzFCLE9BQU8sRUFBRSxFQUFFLEdBQUcsQ0FBRSxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUU7Z0JBQ3hDLGNBQWMsQ0FBQyxDQUFDLElBQUksY0FBYyxDQUFBO2dCQUNsQyxjQUFjLENBQUMsQ0FBQyxJQUFJLGNBQWMsQ0FBQTtnQkFDbEMsaUJBQWlCLEVBQUUsQ0FBQTtZQUNyQixDQUFDLEVBQUU7S0FDSixDQUFBO0lBRUQsSUFBSSxpQkFBaUIsR0FBRyxDQUFDLENBQUE7SUFFekIsTUFBTSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFBO0lBQzNCLEtBQUssQ0FBQyxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQTtJQUNsQyxZQUFZLENB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QUssRUFBRSxPQUFPLENBQUMsQ0FBQTtRQUU5QyxXQUFXLENBQUMsS0FBSyxDQUFDLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxFQUFFLFlBQVksRUFBRSxPQUFPLENBQUMsQ0FBQTtRQUUxRCxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQTtRQUNwQyxNQUFNLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQTtRQUNyQixXQUFXLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUE7UUFDOUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQTtJQUN2RCxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdGVzdCBmcm9tICdAaW50ZXJhY3Rqcy9fZGV2L3Rlc3QvdGVzdCdcbmltcG9ydCBkcmFnIGZyb20gJ0BpbnRlcmFjdGpzL2FjdGlvbnMvZHJhZydcbmltcG9ydCAqIGFzIGhlbHBlcnMgZnJvbSAnQGludGVyYWN0anMvY29yZS90ZXN0cy9faGVscGVycydcbmltcG9ydCBpbmVydGlhIGZyb20gJy4vJ1xuXG50ZXN0KCdpbmVydGlhJywgKHQpID0+IHtcbiAgY29uc3Qge1xuICAgIHNjb3BlLFxuICAgIGludGVyYWN0aW9uLFxuICAgIHRhcmdldCxcbiAgICBpbnRlcmFjdGFibGUsXG4gICAgY29vcmRzLFxuICAgIGV2ZW50LFxuICB9ID0gaGVscGVycy50ZXN0RW52KHsgcGx1Z2luczogW2luZXJ0aWEsIGRyYWddIH0pXG4gIGNvbnN0IGVsZW1lbnQgPSB0YXJnZXQgYXMgSFRNTEVsZW1lbnRcbiAgY29uc3QgbW9kaWZpZXJDaGFuZ2UgPSA1XG4gIGNvbnN0IHRlc3RNb2RpZmllciA9IHtcbiAgICBvcHRpb25zOiB7IGVuZE9ubHk6IHRydWUgfSxcbiAgICBtZXRob2RzOiB7IHNldCAoeyBjb29yZHM6IG1vZGlmaWVyQ29vcmRzIH0pIHtcbiAgICAgIG1vZGlmaWVyQ29vcmRzLnggKz0gbW9kaWZpZXJDaGFuZ2VcbiAgICAgIG1vZGlmaWVyQ29vcmRzLnkgKz0gbW9kaWZpZXJDaGFuZ2VcbiAgICAgIG1vZGlmaWVyQ2FsbENvdW50KytcbiAgICB9IH0sXG4gIH1cblxuICBsZXQgbW9kaWZpZXJDYWxsQ291bnQgPSAwXG5cbiAgY29vcmRzLmNsaWVudCA9IGNvb3Jkcy5wYWdlXG4gIHNjb3BlLm5vdyA9ICgpID0+IGNvb3Jkcy50aW1lU3RhbXBcbiAgaW50ZXJhY3RhYmxlLmRyYWdnYWJsZSh7IGluZXJ0aWE6IHRydWUgfSlcblxuICAvLyB0ZXN0IGluZXJ0aWEgd2l0aG91dCBtb2RpZmllcnMgb3IgdGhyb3dcbiAgZG93blN0YXJ0TW92ZVVwKHsgeDogMTAwLCB5OiAwLCBkdDogMTAwMCB9KVxuICB0Lm5vdE9rKGludGVyYWN0aW9uLmluZXJ0aWEuYWN0aXZlLCAneyBtb2RpZmllcnM6IFtdIH0gJiYgIXRocm93bjogaW5lcnRpYSBpcyBub3QgYWN0aXZhdGVkJylcblxuICAvLyB0ZXN0IGluZXJ0aWEgd2l0aG91dCBtb2RpZmllcnMgYW5kIHdpdGggdGhyb3dcbiAgZG93blN0YXJ0TW92ZVVwKHsgeDogMTAwLCB5OiAwLCBkdDogMTAgfSlcbiAgdC5vayhpbnRlcmFjdGlvbi5pbmVydGlhLmFjdGl2ZSwgJ3Rocm93bjogaW5lcnRpYSBpcyBhY3RpdmF0ZWQnKVxuXG4gIGludGVyYWN0YWJsZS5kcmFnZ2FibGUoeyBtb2RpZmllcnM6IFt0ZXN0TW9kaWZpZXJdIH0pXG5cbiAgLy8gdGVzdCBpbmVydGlhIHdpdGggeyBlbmRPbmx5OiB0cnVlIH0gbW9kaWZpZXIgYW5kIHdpdGggdGhyb3dcbiAgZG93blN0YXJ0TW92ZVVwKHsgeDogMTAwLCB5OiAwLCBkdDogMTAgfSlcbiAgdC5lcXVhbChtb2RpZmllckNhbGxDb3VudCwgMSwgJ3sgZW5kT25seTogdHJ1ZSB9ICYmIHRocm93bjogbW9kaWZpZXIgaXMgbm90IGNhbGxlZCBmcm9tIHBvaW50ZXJVcCcpXG4gIHQuZGVlcEVxdWFsKFxuICAgIGhlbHBlcnMuZ2V0UHJvcHMoaW50ZXJhY3Rpb24uaW5lcnRpYSwgWydtb2RpZmllZFhlJywgJ21vZGlmaWVkWWUnXSksXG4gICAge1xuICAgICAgbW9kaWZpZWRYZTogaW50ZXJhY3Rpb24uaW5lcnRpYS54ZSArIG1vZGlmaWVyQ2hhbmdlLFxuICAgICAgbW9kaWZpZWRZZTogaW50ZXJhY3Rpb24uaW5lcnRpYS55ZSArIG1vZGlmaWVyQ2hhbmdlLFxuICAgIH0sXG4gICAgJ3sgZW5kT25seTogdHJ1ZSB9ICYmIHRocm93bjogaW5lcnRpYSB0YXJnZXQgY29vcmRzIGFyZSBjb3JyZWN0JylcblxuICAvLyB0ZXN0IHNtb290aEVuZCB3aXRoIHsgZW5kT25seTogZmFsc2UgfSBtb2RpZmllclxuICB0ZXN0TW9kaWZpZXIub3B0aW9ucy5lbmRPbmx5ID0gZmFsc2VcbiAgZG93blN0YXJ0TW92ZVVwKHsgeDogMSwgeTogMCwgZHQ6IDEwMDAgfSlcbiAgdC5ub3RPayhpbnRlcmFjdGlvbi5pbmVydGlhLmFjdGl2ZSwgJ3sgZW5kT25seTogZmFsc2UgfSAmJiAhdGhyb3duOiBpbmVydGlhIHNtb290aEVuZCBpcyBub3QgYWN0aXZhdGVkJylcbiAgdC5lcXVhbChtb2RpZmllckNhbGxDb3VudCwgMiwgJ3sgZW5kT25seTogZmFsc2UgfSAmJiAhdGhyb3duOiBtb2RpZmllciBpcyBjYWxsZWQgZnJvbSBwb2ludGVyVXAnKVxuXG4gIC8vIHRlc3Qgc21vb3RoRW5kIHdpdGggeyBlbmRPbmx5OiB0cnVlIH0gbW9kaWZpZXJcbiAgdGVzdE1vZGlmaWVyLm9wdGlvbnMuZW5kT25seSA9IHRydWVcbiAgZG93blN0YXJ0TW92ZVVwKHsgeDogMSwgeTogMCwgZHQ6IDEwMDAgfSlcbiAgdC5vayhpbnRlcmFjdGlvbi5pbmVydGlhLmFjdGl2ZSwgJ3sgZW5kT25seTogdHJ1ZSB9ICYmICF0aHJvd246IGluZXJ0aWEgc21vb3RoRW5kIGlzIGFjdGl2YXRlZCcpXG4gIHQuZXF1YWwobW9kaWZpZXJDYWxsQ291bnQsIDEsICd7IGVuZE9ubHk6IHRydWUgfSAmJiAhdGhyb3duOiBtb2RpZmllciBpcyBub3QgY2FsbGVkIGZyb20gcG9pbnRlclVwJylcblxuICBpbnRlcmFjdGlvbi5zdG9wKClcbiAgdC5lbmQoKVxuXG4gIGZ1bmN0aW9uIGRvd25TdGFydE1vdmVVcCAoeyB4LCB5LCBkdCB9KSB7XG4gICAgbW9kaWZpZXJDYWxsQ291bnQgPSAwXG4gICAgY29vcmRzLnRpbWVTdGFtcCA9IDBcbiAgICBpbnRlcmFjdGlvbi5zdG9wKClcblxuICAgIE9iamVjdC5hc3NpZ24oY29vcmRzLnBhZ2UsIHsgeDogMCwgeTogMCB9KVxuICAgIGludGVyYWN0aW9uLnBvaW50ZXJEb3duKGV2ZW50LCBldmVudCwgZWxlbWVudClcblxuICAgIGludGVyYWN0aW9uLnN0YXJ0KHsgbmFtZTogJ2RyYWcnIH0sIGludGVyYWN0YWJsZSwgZWxlbWVudClcblxuICAgIE9iamVjdC5hc3NpZ24oY29vcmRzLnBhZ2UsIHsgeCwgeSB9KVxuICAgIGNvb3Jkcy50aW1lU3RhbXAgPSBkdFxuICAgIGludGVyYWN0aW9uLnBvaW50ZXJNb3ZlKGV2ZW50LCBldmVudCwgZWxlbWVudClcbiAgICBpbnRlcmFjdGlvbi5wb2ludGVyVXAoZXZlbnQsIGV2ZW50LCBlbGVtZW50LCBlbGVtZW50KVxuICB9XG59KVxuIl19