import { JSDOM } from '@interactjs/_dev/test/domator';
import test from '@interactjs/_dev/test/test';
import interact, { scope } from './interact';
test('interact export', (t) => {
    scope.init(new JSDOM('').window);
    const interactable1 = interact('selector');
    t.assert(interactable1 instanceof scope.Interactable, 'interact function returns Interactable instance');
    t.equal(interact('selector'), interactable1, 'same interactable is returned with same target and context');
    t.equal(scope.interactables.list.length, 1, 'new interactables are added to list');
    interactable1.unset();
    t.equal(scope.interactables.list.length, 0, 'unset interactables are removed');
    const constructsUniqueMessage = 'unique contexts make unique interactables with identical targets';
    const doc1 = new JSDOM('').window.document;
    const doc2 = new JSDOM('').window.document;
    const results = [
        ['repeat', doc1],
        ['repeat', doc2],
        [doc1, doc1],
        [doc2.body, doc2],
    ].reduce((acc, [target, context]) => {
        const interactable = interact(target, { context });
        if (acc.includes(interactable)) {
            t.fail(constructsUniqueMessage);
        }
        acc.push({ interactable, target, context });
        return acc;
    }, []);
    t.pass(constructsUniqueMessage);
    const getsUniqueMessage = 'interactions.get returns correct result with identical targets and different contexts';
    for (const { interactable, target, context } of results) {
        if (scope.interactables.get(target, { context }) !== interactable) {
            t.fail(getsUniqueMessage);
        }
    }
    t.pass(getsUniqueMessage);
    const doc3 = new JSDOM('').window.document;
    const prevDocCount = scope.documents.length;
    interact.addDocument(doc3, { events: { passive: false } });
    t.deepEqual(scope.documents[prevDocCount], { doc: doc3, options: { events: { passive: false } } }, 'interact.addDocument() adds to scope with options');
    interact.removeDocument(doc3);
    t.equal(scope.documents.length, prevDocCount, 'interact.removeDocument() removes document from scope');
    scope.interactables.list.forEach((i) => i.unset());
    const plugin1 = { id: 'test-1', install() { plugin1.count++; }, count: 0 };
    const plugin2 = { id: undefined, install() { plugin2.count++; }, count: 0 };
    interact.use(plugin1);
    interact.use(plugin2);
    t.deepEqual([plugin1.count, plugin2.count], [1, 1], 'new plugin install methods are called');
    interact.use({ ...plugin1 });
    t.deepEqual([plugin1.count, plugin2.count], [1, 1], 'different plugin object with same id not installed');
    interact.use(plugin2);
    t.deepEqual([plugin1.count, plugin2.count], [1, 1], 'plugin without id not re-installed');
    t.end();
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJhY3Quc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVyYWN0LnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLCtCQUErQixDQUFBO0FBQ3JELE9BQU8sSUFBSSxNQUFNLDRCQUE0QixDQUFBO0FBQzdDLE9BQU8sUUFBUSxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sWUFBWSxDQUFBO0FBRTVDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFO0lBQzVCLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUE7SUFFaEMsTUFBTSxhQUFhLEdBQUcsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFBO0lBQzFDLENBQUMsQ0FBQyxNQUFNLENBQUMsYUFBYSxZQUFZLEtBQUssQ0FBQyxZQUFZLEVBQ2xELGlEQUFpRCxDQUFDLENBQUE7SUFDcEQsQ0FBQyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsYUFBYSxFQUN6Qyw0REFBNEQsQ0FBQyxDQUFBO0lBQy9ELENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFDeEMscUNBQXFDLENBQUMsQ0FBQTtJQUV4QyxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUE7SUFDckIsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUN4QyxpQ0FBaUMsQ0FBQyxDQUFBO0lBRXBDLE1BQU0sdUJBQXVCLEdBQzNCLGtFQUFrRSxDQUFBO0lBRXBFLE1BQU0sSUFBSSxHQUFHLElBQUksS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUE7SUFDMUMsTUFBTSxJQUFJLEdBQUcsSUFBSSxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQTtJQUMxQyxNQUFNLE9BQU8sR0FBRztRQUNkLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQztRQUNoQixDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUM7UUFDaEIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ1osQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztLQUNsQixDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsRUFBRSxFQUFFO1FBQ2xDLE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxNQUFNLEVBQUUsRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFBO1FBRWxELElBQUksR0FBRyxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUM5QixDQUFDLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUE7U0FDaEM7UUFFRCxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFBO1FBQzNDLE9BQU8sR0FBRyxDQUFBO0lBQ1osQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFBO0lBRU4sQ0FBQyxDQUFDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxDQUFBO0lBRS9CLE1BQU0saUJBQWlCLEdBQ3JCLHVGQUF1RixDQUFBO0lBRXpGLEtBQUssTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLElBQUksT0FBTyxFQUFFO1FBQ3ZELElBQUksS0FBSyxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEVBQUUsT0FBTyxFQUFFLENBQUMsS0FBSyxZQUFZLEVBQUU7WUFDakUsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFBO1NBQzFCO0tBQ0Y7SUFFRCxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUE7SUFFekIsTUFBTSxJQUFJLEdBQUcsSUFBSSxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQTtJQUUxQyxNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQTtJQUUzQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUE7SUFDMUQsQ0FBQyxDQUFDLFNBQVMsQ0FDVCxLQUFLLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxFQUM3QixFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEVBQUUsTUFBTSxFQUFFLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsRUFDdEQsbURBQW1ELENBQUMsQ0FBQTtJQUV0RCxRQUFRLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQzdCLENBQUMsQ0FBQyxLQUFLLENBQ0wsS0FBSyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQ3RCLFlBQVksRUFDWix1REFBdUQsQ0FBQyxDQUFBO0lBRTFELEtBQUssQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUE7SUFFbEQsTUFBTSxPQUFPLEdBQUcsRUFBRSxFQUFFLEVBQUUsUUFBUSxFQUFFLE9BQU8sS0FBTSxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUEsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFBO0lBQzFFLE1BQU0sT0FBTyxHQUFHLEVBQUUsRUFBRSxFQUFFLFNBQVMsRUFBRSxPQUFPLEtBQU0sT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFBLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQTtJQUUzRSxRQUFRLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3JCLFFBQVEsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUE7SUFFckIsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLHVDQUF1QyxDQUFDLENBQUE7SUFFNUYsUUFBUSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsT0FBTyxFQUFFLENBQUMsQ0FBQTtJQUM1QixDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsb0RBQW9ELENBQUMsQ0FBQTtJQUV6RyxRQUFRLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3JCLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxvQ0FBb0MsQ0FBQyxDQUFBO0lBRXpGLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtBQUNULENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSlNET00gfSBmcm9tICdAaW50ZXJhY3Rqcy9fZGV2L3Rlc3QvZG9tYXRvcidcbmltcG9ydCB0ZXN0IGZyb20gJ0BpbnRlcmFjdGpzL19kZXYvdGVzdC90ZXN0J1xuaW1wb3J0IGludGVyYWN0LCB7IHNjb3BlIH0gZnJvbSAnLi9pbnRlcmFjdCdcblxudGVzdCgnaW50ZXJhY3QgZXhwb3J0JywgKHQpID0+IHtcbiAgc2NvcGUuaW5pdChuZXcgSlNET00oJycpLndpbmRvdylcblxuICBjb25zdCBpbnRlcmFjdGFibGUxID0gaW50ZXJhY3QoJ3NlbGVjdG9yJylcbiAgdC5hc3NlcnQoaW50ZXJhY3RhYmxlMSBpbnN0YW5jZW9mIHNjb3BlLkludGVyYWN0YWJsZSxcbiAgICAnaW50ZXJhY3QgZnVuY3Rpb24gcmV0dXJucyBJbnRlcmFjdGFibGUgaW5zdGFuY2UnKVxuICB0LmVxdWFsKGludGVyYWN0KCdzZWxlY3RvcicpLCBpbnRlcmFjdGFibGUxLFxuICAgICdzYW1lIGludGVyYWN0YWJsZSBpcyByZXR1cm5lZCB3aXRoIHNhbWUgdGFyZ2V0IGFuZCBjb250ZXh0JylcbiAgdC5lcXVhbChzY29wZS5pbnRlcmFjdGFibGVzLmxpc3QubGVuZ3RoLCAxLFxuICAgICduZXcgaW50ZXJhY3RhYmxlcyBhcmUgYWRkZWQgdG8gbGlzdCcpXG5cbiAgaW50ZXJhY3RhYmxlMS51bnNldCgpXG4gIHQuZXF1YWwoc2NvcGUuaW50ZXJhY3RhYmxlcy5saXN0Lmxlbmd0aCwgMCxcbiAgICAndW5zZXQgaW50ZXJhY3RhYmxlcyBhcmUgcmVtb3ZlZCcpXG5cbiAgY29uc3QgY29uc3RydWN0c1VuaXF1ZU1lc3NhZ2UgPVxuICAgICd1bmlxdWUgY29udGV4dHMgbWFrZSB1bmlxdWUgaW50ZXJhY3RhYmxlcyB3aXRoIGlkZW50aWNhbCB0YXJnZXRzJ1xuXG4gIGNvbnN0IGRvYzEgPSBuZXcgSlNET00oJycpLndpbmRvdy5kb2N1bWVudFxuICBjb25zdCBkb2MyID0gbmV3IEpTRE9NKCcnKS53aW5kb3cuZG9jdW1lbnRcbiAgY29uc3QgcmVzdWx0cyA9IFtcbiAgICBbJ3JlcGVhdCcsIGRvYzFdLFxuICAgIFsncmVwZWF0JywgZG9jMl0sXG4gICAgW2RvYzEsIGRvYzFdLFxuICAgIFtkb2MyLmJvZHksIGRvYzJdLFxuICBdLnJlZHVjZSgoYWNjLCBbdGFyZ2V0LCBjb250ZXh0XSkgPT4ge1xuICAgIGNvbnN0IGludGVyYWN0YWJsZSA9IGludGVyYWN0KHRhcmdldCwgeyBjb250ZXh0IH0pXG5cbiAgICBpZiAoYWNjLmluY2x1ZGVzKGludGVyYWN0YWJsZSkpIHtcbiAgICAgIHQuZmFpbChjb25zdHJ1Y3RzVW5pcXVlTWVzc2FnZSlcbiAgICB9XG5cbiAgICBhY2MucHVzaCh7IGludGVyYWN0YWJsZSwgdGFyZ2V0LCBjb250ZXh0IH0pXG4gICAgcmV0dXJuIGFjY1xuICB9LCBbXSlcblxuICB0LnBhc3MoY29uc3RydWN0c1VuaXF1ZU1lc3NhZ2UpXG5cbiAgY29uc3QgZ2V0c1VuaXF1ZU1lc3NhZ2UgPVxuICAgICdpbnRlcmFjdGlvbnMuZ2V0IHJldHVybnMgY29ycmVjdCByZXN1bHQgd2l0aCBpZGVudGljYWwgdGFyZ2V0cyBhbmQgZGlmZmVyZW50IGNvbnRleHRzJ1xuXG4gIGZvciAoY29uc3QgeyBpbnRlcmFjdGFibGUsIHRhcmdldCwgY29udGV4dCB9IG9mIHJlc3VsdHMpIHtcbiAgICBpZiAoc2NvcGUuaW50ZXJhY3RhYmxlcy5nZXQodGFyZ2V0LCB7IGNvbnRleHQgfSkgIT09IGludGVyYWN0YWJsZSkge1xuICAgICAgdC5mYWlsKGdldHNVbmlxdWVNZXNzYWdlKVxuICAgIH1cbiAgfVxuXG4gIHQucGFzcyhnZXRzVW5pcXVlTWVzc2FnZSlcblxuICBjb25zdCBkb2MzID0gbmV3IEpTRE9NKCcnKS53aW5kb3cuZG9jdW1lbnRcblxuICBjb25zdCBwcmV2RG9jQ291bnQgPSBzY29wZS5kb2N1bWVudHMubGVuZ3RoXG5cbiAgaW50ZXJhY3QuYWRkRG9jdW1lbnQoZG9jMywgeyBldmVudHM6IHsgcGFzc2l2ZTogZmFsc2UgfSB9KVxuICB0LmRlZXBFcXVhbChcbiAgICBzY29wZS5kb2N1bWVudHNbcHJldkRvY0NvdW50XSxcbiAgICB7IGRvYzogZG9jMywgb3B0aW9uczogeyBldmVudHM6IHsgcGFzc2l2ZTogZmFsc2UgfSB9IH0sXG4gICAgJ2ludGVyYWN0LmFkZERvY3VtZW50KCkgYWRkcyB0byBzY29wZSB3aXRoIG9wdGlvbnMnKVxuXG4gIGludGVyYWN0LnJlbW92ZURvY3VtZW50KGRvYzMpXG4gIHQuZXF1YWwoXG4gICAgc2NvcGUuZG9jdW1lbnRzLmxlbmd0aCxcbiAgICBwcmV2RG9jQ291bnQsXG4gICAgJ2ludGVyYWN0LnJlbW92ZURvY3VtZW50KCkgcmVtb3ZlcyBkb2N1bWVudCBmcm9tIHNjb3BlJylcblxuICBzY29wZS5pbnRlcmFjdGFibGVzLmxpc3QuZm9yRWFjaCgoaSkgPT4gaS51bnNldCgpKVxuXG4gIGNvbnN0IHBsdWdpbjEgPSB7IGlkOiAndGVzdC0xJywgaW5zdGFsbCAoKSB7IHBsdWdpbjEuY291bnQrKyB9LCBjb3VudDogMCB9XG4gIGNvbnN0IHBsdWdpbjIgPSB7IGlkOiB1bmRlZmluZWQsIGluc3RhbGwgKCkgeyBwbHVnaW4yLmNvdW50KysgfSwgY291bnQ6IDAgfVxuXG4gIGludGVyYWN0LnVzZShwbHVnaW4xKVxuICBpbnRlcmFjdC51c2UocGx1Z2luMilcblxuICB0LmRlZXBFcXVhbChbcGx1Z2luMS5jb3VudCwgcGx1Z2luMi5jb3VudF0sIFsxLCAxXSwgJ25ldyBwbHVnaW4gaW5zdGFsbCBtZXRob2RzIGFyZSBjYWxsZWQnKVxuXG4gIGludGVyYWN0LnVzZSh7IC4uLnBsdWdpbjEgfSlcbiAgdC5kZWVwRXF1YWwoW3BsdWdpbjEuY291bnQsIHBsdWdpbjIuY291bnRdLCBbMSwgMV0sICdkaWZmZXJlbnQgcGx1Z2luIG9iamVjdCB3aXRoIHNhbWUgaWQgbm90IGluc3RhbGxlZCcpXG5cbiAgaW50ZXJhY3QudXNlKHBsdWdpbjIpXG4gIHQuZGVlcEVxdWFsKFtwbHVnaW4xLmNvdW50LCBwbHVnaW4yLmNvdW50XSwgWzEsIDFdLCAncGx1Z2luIHdpdGhvdXQgaWQgbm90IHJlLWluc3RhbGxlZCcpXG5cbiAgdC5lbmQoKVxufSlcbiJdfQ==